<h1>Gestão de Dívidas</h1>

<!-- Seção de Notificações -->
<% if @dividas.any? { |d| d.status == 'pendente' && d.data_vencimento < Date.today } %>
  <div style="color: red; font-weight: bold;">
    <p>Atenção! Há dívidas vencidas.</p>
  </div>
<% elsif @dividas.any? { |d| d.status == 'pendente' && d.data_vencimento <= Date.today + 3 } %>
  <div style="color: orange; font-weight: bold;">
    <p>Alerta! Existem dívidas próximas do vencimento.</p>
  </div>
<% end %>

<table>
  <thead>
    <tr>
      <th>Cliente</th>
      <th>Valor</th>
      <th>Data de Vencimento</th>
      <th>Status</th>
      <th>Ações</th>
    </tr>
  </thead>

  <tbody>
    <% @dividas.each do |divida| %>
      <tr>
        <td><%= divida.cliente.nome %></td>
        <td><%= number_to_currency(divida.valor) %></td>
        <td><%= divida.data_vencimento.strftime("%d/%m/%Y") %></td>
        <td><%= divida.status.capitalize %></td>
        <td>
          <%= link_to 'Show', divida %> |
          <%= link_to 'Edit', edit_divida_path(divida) %> |
          <%= link_to 'Delete', divida, method: :delete, data: { confirm: 'Tem certeza?' } %>
        </td>
      </tr>
    <% end %>
  </tbody>
</table>

<%= link_to 'Nova Dívida', new_divida_path %>

<!-- Seção de Relatórios -->
<h2>Relatórios</h2>
<form method="get" action="<%= relatorios_path %>">
  <label>Período:</label>
  <select name="periodo">
    <option value="7">Últimos 7 dias</option>
    <option value="30">Últimos 30 dias</option>
    <option value="90">Últimos 3 meses</option>
    <option value="custom">Personalizado</option>
  </select>
  <br>
  <label>Data Início:</label>
  <input type="date" name="data_inicio">
  <label>Data Fim:</label>
  <input type="date" name="data_fim">
  <br>
  <input type="submit" value="Gerar Relatório">
</form>
